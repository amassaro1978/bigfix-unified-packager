<# .SYNOPSIS A PowerShell based tool to present a front GUI to allow automatic creation of packaging fixlets. .DESCRIPTION Click the "Select Deployment Specs Document" button to select your deployment specs document and it will auto-populate all of the fields. Enter your credentials at the bottom of the tool and click the "Generate and POST Fixlets" button to create and post the 3 packaging fixlets. .AUTHOR Anthony Massaro #> # Add Assemblies Add-Type -AssemblyName System.Windows.Forms Add-Type -AssemblyName System.Drawing Add-Type -AssemblyName System.Web Add-Type -AssemblyName System.IO.Compression.FileSystem $ToolVer = "0.1.1 - Modern UI Test" # ========================= # Helper Functions # ========================= function Get-WordXML { param($docxpath) $tempFolder = Join-Path $env:TEMP ("docx_" + [System.IO.Path]::GetFileNameWithoutExtension($docxPath)) if (Test-path $tempFolder) { Remove-Item -Path $tempFolder -Recurse -Force } [System.IO.Compression.ZipFile]::ExtractToDirectory($docxPath, $tempFolder) $xmlPath = Join-Path $tempFolder "word/document.xml" $xmlDoc = New-Object System.Xml.XmlDocument $xmlDoc.Load($xmlPath) return $xmlDoc } function New-TextBox { param ($x, $y, $width = 580, $height = 20, $multiline = $false) $box = New-Object System.Windows.Forms.TextBox $box.Location = New-Object System.Drawing.Point($x, $y) $box.Size = New-Object System.Drawing.Size($width, $height) $box.Multiline = $multiline return $box } function Style-TextBox($tb) { $tb.BackColor = [System.Drawing.ColorTranslator]::FromHtml("#3C3C3C") $tb.ForeColor = [System.Drawing.Color]::White $tb.BorderStyle = "FixedSingle" } function Style-Button($btn) { $btn.FlatStyle = "Flat" $btn.BackColor = [System.Drawing.ColorTranslator]::FromHtml("#0078D7") $btn.ForeColor = [System.Drawing.Color]::White $btn.FlatAppearance.BorderSize = 0 $btn.FlatAppearance.MouseOverBackColor = [System.Drawing.ColorTranslator]::FromHtml("#3399FF") } # ========================= # Form # ========================= $form = New-Object System.Windows.Forms.Form $form.Text = "BigFix Fixlet Generator (Modern UI Test) v $toolVer" $form.Size = New-Object System.Drawing.Size(800, 950) $form.StartPosition = "CenterScreen" $form.BackColor = [System.Drawing.ColorTranslator]::FromHtml("#2D2D30") $form.ForeColor = [System.Drawing.Color]::White $form.Font = New-Object System.Drawing.Font("Segoe UI", 10) # ========================= # Controls # ========================= # Deployment Doc button $btnLoadDocx = New-Object System.Windows.Forms.Button $btnLoadDocx.text = "Select Deployment Specs Document" $btnLoadDocx.Width = 250 $btnLoadDocx.Height = 32 $btnLoadDocx.Location = New-Object System.Drawing.Point(10,10) Style-Button $btnLoadDocx # Fields $labelVendor = New-Object System.Windows.Forms.Label -Property @{Text="Vendor:"; Location=New-Object System.Drawing.Point(10,60)} $textVendor = New-TextBox 120 60 Style-TextBox $textVendor $labelApp = New-Object System.Windows.Forms.Label -Property @{Text="Application Name:"; Location=New-Object System.Drawing.Point(10,90)} $textApp = New-TextBox 120 90 Style-TextBox $textApp $labelVer = New-Object System.Windows.Forms.Label -Property @{Text="Version:"; Location=New-Object System.Drawing.Point(10,120)} $textVer = New-TextBox 120 120 Style-TextBox $textVer $labelSite = New-Object System.Windows.Forms.Label -Property @{Text="Site:"; Location=New-Object System.Drawing.Point(10,150)} $textSite = New-Object System.Windows.Forms.ComboBox $textSite.Location = New-Object System.Drawing.Point(120,150) $textSite.Width = 400 $textSite.DropDownStyle = [System.Windows.Forms.ComboBoxStyle]::DropDownList $textSite.Items.Add("test site 1") $textSite.Items.Add("test 2 (Workstations)") $textSite.SelectedIndex = 0 $form.Controls.AddRange(@($labelVendor,$textVendor,$labelApp,$textApp,$labelVer,$textVer,$labelSite,$textSite)) # Fixlet blocks function Add-FixletBlock { param($form, $labelText, $yStart, [ref]$relRef, [ref]$actRef) $labelRel = New-Object System.Windows.Forms.Label -Property @{Text="$labelText Relevance:"; Location=New-Object System.Drawing.Point(10, $ystart)} $boxRel = New-TextBox 150 $yStart 580 60 $true Style-TextBox $boxRel $labelAct = New-Object System.Windows.Forms.Label -Property @{Text="$labelText Action Script:"; Location=New-Object System.Drawing.Point(10, ($ystart+70))} $boxAct = New-TextBox 150 ($yStart+70) 580 60 $true Style-TextBox $boxAct $form.Controls.AddRange(@($labelRel,$boxRel,$labelAct,$boxAct)) $relRef.Value=$boxRel; $actRef.Value=$boxAct } $InstallRel=$null;$InstallAct=$null $UpdateRel=$null;$UpdateAct=$null $RemoveRel=$null;$RemoveAct=$null Add-FixletBlock -form $form -labeltext "Install" -yStart 190 -relRef ([ref]$InstallRel) -actRef ([ref]$InstallAct) Add-FixletBlock -form $form -labeltext "Update" -yStart 350 -relRef ([ref]$UpdateRel) -actRef ([ref]$UpdateAct) Add-FixletBlock -form $form -labeltext "Remove" -yStart 510 -relRef ([ref]$RemoveRel) -actRef ([ref]$RemoveAct) # Server dropdown $labelServer = New-Object System.Windows.Forms.Label -Property @{Text="BigFix Server:"; Location=New-Object System.Drawing.Point(10,660)} $textServer = New-Object System.Windows.Forms.ComboBox $textServer.Location = New-Object System.Drawing.Point(150,660) $textServer.Width = 400 $textServer.DropDownStyle = [System.Windows.Forms.ComboBoxStyle]::DropDownList $textServer.Items.Add("https://dev.server:52311") $textServer.Items.Add("https://prod.server:52311") $textServer.SelectedIndex=0 # Username/Password $labelUser = New-Object System.Windows.Forms.Label -Property @{Text="Username:"; Location=New-Object System.Drawing.Point(10,690)} $textUser = New-TextBox 150 690 200 Style-TextBox $textUser $labelPass = New-Object System.Windows.Forms.Label -Property @{Text="Password:"; Location=New-Object System.Drawing.Point(10,720)} $textPass = New-TextBox 150 720 200 $textPass.PasswordChar='*' Style-TextBox $textPass $form.Controls.AddRange(@($labelServer,$textServer,$labelUser,$textUser,$labelPass,$textPass)) # Buttons $btnSend = New-Object System.Windows.Forms.Button $btnSend.Text = "Generate and POST Fixlets" $btnSend.Size = '250,32' $btnSend.Location = New-Object System.Drawing.Point(240,770) Style-Button $btnSend # Logbox $LogBox = New-Object System.Windows.Forms.TextBox $LogBox.Multiline=$true $LogBox.ScrollBars="Vertical" $LogBox.ReadOnly=$true $LogBox.WordWrap=$false $LogBox.Location=New-Object System.Drawing.Point(10,820) $LogBox.Size=New-Object System.Drawing.Size(760,80) $LogBox.BackColor = [System.Drawing.ColorTranslator]::FromHtml("#1E1E1E") $LogBox.ForeColor = [System.Drawing.ColorTranslator]::FromHtml("#CCCCCC") $form.Controls.AddRange(@($btnLoadDocx,$btnSend,$LogBox)) # ========================= # Event Handlers (shortened for test) # ========================= $btnLoadDocx.Add_Click({ [System.Windows.Forms.MessageBox]::Show("Pretend we loaded a docx","Test") }) $btnSend.Add_Click({ $LogBox.AppendText("Pretend we posted fixlets successfully.`r`n") }) $form.TopMost=$true $form.Add_Shown({$form.Activate()}) [void]$form.ShowDialog()